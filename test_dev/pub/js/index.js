/* @generated */G.def("JSON2",function(){function f(a){return a<10?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return typeof b=="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g=gap,h,i=b[a];i&&typeof i=="object"&&typeof i.toJSON=="function"&&(i=i.toJSON(a)),typeof rep=="function"&&(i=rep.call(b,a,i));switch(typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";gap+=indent,h=[];if(Object.prototype.toString.apply(i)==="[object Array]"){f=i.length;for(c=0;c<f;c+=1)h[c]=str(c,i)||"null";return e=h.length===0?"[]":gap?"[\n"+gap+h.join(",\n"+gap)+"\n"+g+"]":"["+h.join(",")+"]",gap=g,e}if(rep&&typeof rep=="object"){f=rep.length;for(c=0;c<f;c+=1)typeof rep[c]=="string"&&(d=rep[c],e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e))}else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&h.push(quote(d)+(gap?": ":":")+e));return e=h.length===0?"{}":gap?"{\n"+gap+h.join(",\n"+gap)+"\n"+g+"}":"{"+h.join(",")+"}",gap=g,e}}"use strict",window.JSON||(window.JSON={}),typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(a,b,c){var d;gap="",indent="";if(typeof c=="number")for(d=0;d<c;d+=1)indent+=" ";else typeof c=="string"&&(indent=c);rep=b;if(!b||typeof b=="function"||typeof b=="object"&&typeof b.length=="number")return str("",{"":a});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&typeof e=="object")for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),d!==undefined?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()),G.def("store",["JSON2"],function(){"use strict";var a="localStorage"in window,b={set:function(){},get:function(){},remove:function(){},clear:function(){},isSupport:!1};if(a){var c=window.localStorage,d=function(a,b){var d=c[a];return function(e){setTimeout(function(){e=e||window.storageEvent;var f=e.key,g=e.newValue;if(!f){var h=c[a];h!=d&&(f=a,g=h)}f==a&&(b&&b(g==null?null:JSON.parse(g)),d=g)},0)}};b.set=function(a,b){c.setItem(a,JSON.stringify(b))},b.get=function(a){var d=c.getItem(a),e=d==null?null:JSON.parse(d);return e!==null&&e.date&&e.expiredDate&&b._expired(a,e.expiredDate,e.date)&&(e=null),e},b.remove=function(a){c.removeItem(a)},b.clear=function(){c.clear()},b.onStorage=function(a,b){window.addEventListener?window.addEventListener("storage",d(a,b),!1):document.attachEvent("storage",d(a,b))},b._expired=function(a,c,d){return(new Date).getTime()-d>=c*864e5?(b.remove(a),!0):!1},b.isSupport=!0}else b={o:null,defExps:365,init:function(){if(!b.o)try{b.o=document.createElement("input"),b.o.type="hidden",b.o.addBehavior("#default#userData"),document.body.appendChild(b.o)}catch(a){return!1}return!0},set:function(a,c,d){if(b.init()){var e=b.o;e.load(a),c&&e.setAttribute("code",JSON.stringify(c));var f=new Date,d=d?d:b.defExps;f.setDate(f.getDate()+d),e.expires=f.toUTCString(),e.save(a)}},get:function(a){if(b.init()){var c=b.o;return c.load(a),typeof c.getAttribute("code")=="undefined"?null:JSON.parse(c.getAttribute("code"))}},onStorage:function(){},remove:function(a){b.set(a,!1,-365)},isSupport:!0};return b}),G.def("tmpl",function(){function a(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}var b={entities:a};return function(c,d){/\W/.test(c)||(c=document.getElementById(c).innerHTML);var e=new Function("funcs, obj","var p=[],print=function(){p.push.apply(p,arguments);};with(funcs){with(obj){p.push('"+c.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',entities($1),'").replace(/\t:=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}}return p.join('');");return d?e(b,d):function(a){return e(b,a)}}}),G.def("slide",function(){function b(a,b,c,d){c.hide(),c.eq(a).show(),d.removeClass(b),d.eq(a).addClass(b)}"use strict";var a="current";return function(c,d,e,f){function o(c){f&&f.showEffect?f.showEffect(c,a,k,m):b(c,a,k,m)}function p(){i=0}function q(){i=1}var g=d||0,h=e||5e3,i=1,j=c.children().eq(0),k=j.children(),l=c.children().eq(1),m=l.children(),n=m.length;return o(g),h!==-1&&setInterval(function(){i&&(g++,g%=n,o(g))},h),j.hover(p,q),m.mouseover(function(){p(),g=m.index(this),o(g)}).mouseout(q),{show:function(){return o(),this},stop:function(){return p(),this},start:function(){return q(),this}}}}),G.def("homeSlide",function(){function b(a,b,c,d){if($.isArray(c))for(var e=0,f=c.length;e<f;e++)c[e].hide(),c[e].eq(a).show();else c.hide(),c.eq(a).show();d.removeClass(b),d.eq(a).addClass(b)}"use strict";var a="current";return function(c,d,e,f,g){function n(d){g&&g.showEffect?g.showEffect(d,a,c,k):b(d,a,c,k)}function o(){j=0}function p(){j=1}function q(){i!==-1&&(m=setInterval(function(){j&&(h++,h%=l,n(h))},i))}var h=e||0,i=f||5e3,j=1,c=c,k=d,l=k.length,m;n(h),q();if($.isArray(c))for(var r=0,s=c.length;r<s;r++)c[r].hover(o,p);else c.hover(o,p);return k.click(function(){o(),clearInterval(m),h=k.index(this),n(h),p(),q()}),{show:function(){return n(),this},stop:function(){return o(),this},start:function(){return p(),this}}}}),G.def("./home/indexPage",["../lib/store","../lib/tmpl","../lib/slide","../lib/homeSlide"],function(a,b,c,d){return{login:function(){var a=function(a,b){var c=a-b;return c<600?"刚刚":c<3600?Math.floor(c/60)+"分钟前":c<86400?Math.floor(c/3600)+"小时前":c<2592e3?Math.floor(c/86400)+"天前":"好久好久以前"},c="/apis/community/user/activity/feed.json",d={limit:6},e='<li><p class="gellipsis"><a href="<%=user_url%>" target="_blank"><%=user_name%></a><%=user_action%><a target="_blank" data-gaevent="<%=ga_event%>" href="<%=article_url%>"><%=article_name%></a></p><span><%=time%><span></span></span></li>',f=function(c){var d="",f=Math.floor(+(new Date(c.now.substring(0,19).replace(/-/g,"/").replace("T"," ")))/1e3);return $.each(c.result,function(){var c=this.user.url,g=this.user.nickname,h=this.user.action,i=this.object.url,j=this.object.title,k=a(f,+this.date_created),l="home_activity_"+this.object.descriptor.split(":")[0]+":activity";d+=b(e,{user_url:c,user_name:g,user_action:h,article_url:i,article_name:j,time:k,ga_event:l})}),d};$.ajax({type:"GET",url:c,data:d,dataType:"json",cache:!0,success:function(a){$(".user-asks ul").append(f(a))}})},unlogin:function(){var a=$(".gkr-unlogin-more-nav"),b=a.find(".gkr-umn-pop"),c=null;navigator.userAgent.match(/iPad/i)?a.click(function(){b.toggle()}):a.hover(function(){c=setTimeout(function(){b.slideDown("fast")},300)},function(){c&&clearTimeout(c),b.slideUp("slow")})},all:function(){$("#refreshGroups").doOnce(function(){var a=$("#newGroups").find("ul"),b=a.length,c=0;$(this).click(function(){c=++c%b,a.eq(c).show().siblings().hide()})});var b=function(a,b){var c=$(a).find("ul"),d=c.length,e=0;b.click(function(){var a=c.eq(e),b;e++,e%=d,b=c.eq(e),a.hide(),b.show()})};d([$(".focus-content a"),$(".focus-title li")],$(".focus-tag li"),0,4e3);var c=$("#hotTopics");$.get("/apis/flowingboard/flowingboard.json",{name:"youth"},function(a){if(a.result===null||a.result.length===0||a.result[0]===null)return;var b=a.result[0],d={items:[]},e=parseInt(c.css("width")),f=0,g='<div class="focus-content"><a data-gaevent="home_zhuanti:home" href="{{items.url}}" title="{{items.title}}" target="_blank"><img src="{{items.image}}"></a></div>',h=0;for(var i in b.items)b.items[i].url&&b.items[i].image&&(b.items[i].image=b.items[i].image.replace(/\/(image|thumbnail)(\/[\w-]{56})(_\d*x\d*)?\./,"/thumbnail$2_290x160."),d.items.push(b.items[i]));d.items.length>0&&(c.addClass("side-promote"),h=Math.floor(Math.random()*d.items.length),g=g.replace("{{items.url}}",d.items[h].url).replace("{{items.title}}",d.items[h].title).replace("{{items.image}}",d.items[h].image),c.html(g))},"json"),$("#refreshNuts").doOnce(function(){b("#hotNuts",$(this))}),$("#refreshTags").doOnce(function(){b("#hotTags",$(this))}),$("#refreshGroups").doOnce(function(){b("#newGroups",$(this))}),a.get("ad-home-top")===null&&$("#topAds").doOnce(function(){$("#topAds").show(),$(".closeAds").click(function(){a.set("ad-home-top",{isShow:"true",date:(new Date).getTime(),expiredDate:1},1);var b=$(this).parent(),c=$(this).attr("data-flag"),d=$(this).attr("data-version");_gaq.push(["_trackEvent",c,d]),b.remove()})})}}});if(typeof g_page_name!="undefined"){typeof ukey=="undefined"&&(ukey="");var moduleName=g_page_name.replace(/home/g,"");moduleName=moduleName.slice(0,1).toLowerCase()+moduleName.slice(1),G.req("./home/"+moduleName,function(a){"use strict";if(a==null)return;var b=ukey?"login":"unlogin";a[b]&&a[b](ukey),a.all&&a.all()})}